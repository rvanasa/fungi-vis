Bundle { input: "let set :\n(Thk [0] foralli X : NmSet . 0 Nm [X] -> 0 Nat -> { { @ ! } X ; 0 } F Ref\n [{ @ ! } X] Nat) = { ret thunk # n . # x . ref n x } ret 0", program: Der { ctx: Empty, dir: Synth, term: Let("set", AnnoC(Ret(ThunkAnon(Lam("n", Lam("x", Ref(Var("n"), Var("x")))))), Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Ident("Nat"), Cons(Lift(Ref(App(WriteScope, Var("X")), Ident("Nat"))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty)))))), Ret(Nat(0))), clas: Ok(Cons(Lift(Prim(Nat)), WR(Empty, Empty))), rule: Let("set", Der { ctx: Empty, dir: Synth, term: AnnoC(Ret(ThunkAnon(Lam("n", Lam("x", Ref(Var("n"), Var("x")))))), Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Ident("Nat"), Cons(Lift(Ref(App(WriteScope, Var("X")), Ident("Nat"))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty)))))), clas: Ok(Cons(Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty))))), WR(Empty, Empty))), rule: AnnoC(Der { ctx: Empty, dir: Check(Cons(Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty))))), WR(Empty, Empty))), term: Ret(ThunkAnon(Lam("n", Lam("x", Ref(Var("n"), Var("x")))))), clas: Ok(Cons(Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty))))), WR(Empty, Empty))), rule: Ret(Der { ctx: Empty, dir: Check(Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty))))), term: ThunkAnon(Lam("n", Lam("x", Ref(Var("n"), Var("x"))))), clas: Ok(Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty))))), rule: ThunkAnon(Der { ctx: Empty, dir: Check(ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), term: Lam("n", Lam("x", Ref(Var("n"), Var("x")))), clas: Ok(Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty))), rule: Lam("n", Der { ctx: Var(IVar(Empty, "X", NmSet), "n", Nm(Var("X"))), dir: Check(Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), term: Lam("x", Ref(Var("n"), Var("x"))), clas: Ok(Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), rule: Lam("x", Der { ctx: Var(Var(IVar(Empty, "X", NmSet), "n", Nm(Var("X"))), "x", Prim(Nat)), dir: Check(Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), term: Ref(Var("n"), Var("x")), clas: Ok(Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), rule: Ref(Der { ctx: Var(Var(IVar(Empty, "X", NmSet), "n", Nm(Var("X"))), "x", Prim(Nat)), dir: Synth, term: Var("n"), clas: Ok(Nm(Var("X"))), rule: Var("n"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(Var(IVar(Empty, "X", NmSet), "n", Nm(Var("X"))), "x", Prim(Nat)), dir: Check(Prim(Nat)), term: Var("x"), clas: Ok(Prim(Nat)), rule: Var("x"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty)))))), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Empty, "set", Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty))))), dir: Synth, term: Ret(Nat(0)), clas: Ok(Cons(Lift(Prim(Nat)), WR(Empty, Empty))), rule: Ret(Der { ctx: Var(Empty, "set", Thk(Empty, ForallIdx("X", NmSet, Tt, Cons(Arrow(Nm(Var("X")), Cons(Arrow(Prim(Nat), Cons(Lift(Ref(App(WriteScope, Var("X")), Prim(Nat))), WR(App(WriteScope, Var("X")), Empty))), WR(Empty, Empty))), WR(Empty, Empty))))), dir: Synth, term: Nat(0), clas: Ok(Prim(Nat)), rule: Nat(0), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, traces: [] }