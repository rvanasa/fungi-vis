Bundle { input: "decls\n{\n    /// Optional natural numbers:\n     type OpNat = (+ Unit + Nat) ;\n    /// Compute the maximum optional natural number (among a pair)\n     fn opnat_max : (Thk [0] 0 OpNat -> 0 OpNat -> 0 F OpNat) =\n    {\n        # xo . # yo . match (xo)\n        {\n            _u => { ret yo } x =>\n            {\n                match (yo)\n                {\n                    _u => { ret yo } y =>\n                    { if { x < y } { ret yo } else { ret xo } }\n                }\n            }\n        }\n    } /// Levels (as numbers), for level trees.\n     type Lev = (Nat) ;\n    /// Sequences (balanced binary level trees), whose leaves\n     /// are optional natural numbers:\n     type Seq =\n    (rec seq . foralli (X, Y) : NmSet .\n     (+ (+ Unit + Nat) +\n      (exists (X1, X2, X3) : NmSet | ((X1 % X2 % X3) = X : NmSet) . exists\n       (Y1, Y2, Y3, Y4) : NmSet | ((Y1 % Y2 % Y3 % Y4) = Y : NmSet) . x Nm\n       [X1] x Lev x Ref [Y1] (seq [X2] [Y2]) x Ref [Y3] (seq [X3] [Y4])))) ;\n    /// Pointers written for each name in a structural recursion\n     /// (-`_SR`) over a sequence:\n     idxtm Seq_SR = (# x : Nm . ({ x * @ 1 }) % ({ x * @ 2 })) ;\n    /// ... prefixed with the current write scope (`WS`-), named\n     /// `@!` below, as a nameset-level function\n     idxtm WS_Seq_SR = (# x : NmSet . { @ ! } ((Seq_SR) x)) ;\n} let max :\n(Thk [0] foralli (X, Y) : NmSet . 0 Seq [X] [Y] ->\n { { WS_Seq_SR } X ; Y % ({ WS_Seq_SR } X) } F OpNat) =\n{\n    ret thunk fix max . # seq . unroll match seq\n    {\n        on => { ret on } bin =>\n        {\n            unpack (X1, X2, X3, Y1, Y2, Y3, Y4) bin = bin let (n, lev, l, r) =\n            { ret bin } let (_rsl, ml) =\n            { memo { n, (@ 1) } { { force max } [X2] [Y2] { ! l } } } let\n            (_rsr, mr) =\n            { memo { n, (@ 2) } { { force max } [X3] [Y4] { ! r } } }\n            { { force opnat_max } ml mr }\n        }\n    }\n} ret 0", program: Der { ctx: Empty, dir: Synth, term: Decls(Doc("r\" Optional natural numbers:\"", Type("OpNat", Sum(Unit, Ident("Nat")), Doc("r\" Compute the maximum optional natural number (among a pair)\"", Fn("opnat_max", Thk(Empty, Cons(Arrow(Ident("OpNat"), Cons(Arrow(Ident("OpNat"), Cons(Lift(Ident("OpNat")), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty))), Lam("xo", Lam("yo", Case(Var("xo"), "_u", Ret(Var("yo")), "x", Case(Var("yo"), "_u", Ret(Var("yo")), "y", Let("sugar_if_scrutinee", PrimApp(NatLt(Var("x"), Var("y"))), IfThenElse(Var("sugar_if_scrutinee"), Ret(Var("yo")), Ret(Var("xo")))))))), Doc("r\" Levels (as numbers), for level trees.\"", Type("Lev", Ident("Nat"), Doc("r\" Sequences (balanced binary level trees), whose leaves\"", Doc("r\" are optional natural numbers:\"", Type("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Ident("Nat")), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Ident("Lev"), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Doc("r\" Pointers written for each name in a structural recursion\"", Doc("r\" (-`_SR`) over a sequence:\"", IdxTm("Seq_SR", Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Doc("r\" ... prefixed with the current write scope (`WS`-), named\"", Doc("r\" `@!` below, as a nameset-level function\"", IdxTm("WS_Seq_SR", Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))), End))))))))))))))), Let("max", AnnoC(Ret(ThunkAnon(Fix("max", Lam("seq", Unroll(Var("seq"), "sugar_match_unroll", Case(Var("sugar_match_unroll"), "on", Ret(Var("on")), "bin", Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))))))))))))))), Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(Ident("Seq"), Var("X")), Var("Y")), Cons(Lift(Ident("OpNat")), WR(App(Ident("WS_Seq_SR"), Var("X")), Apart(Var("Y"), App(Ident("WS_Seq_SR"), Var("X")))))), WR(Empty, Empty))))))), Ret(Nat(0)))), clas: Ok(Cons(Lift(Prim(Nat)), WR(Empty, Empty))), rule: Decls([Bind(ItemDer { doc: Some("r\" Optional natural numbers:\""), qual: Type, var: "OpNat", der: Der { ctx: Empty, dir: Synth, term: (), clas: Ok(Kind(NoParse("TODO-XXX-bitype.rs"))), rule: Type("OpNat", Sum(Unit, Prim(Nat))), vis: DerVis { tmfam: "Module", local_err: false } } }), Bind(ItemDer { doc: Some("r\" Compute the maximum optional natural number (among a pair)\""), qual: Val, var: "opnat_max", der: Der { ctx: Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), dir: Synth, term: (), clas: Ok(Type(Thk(Empty, Cons(Arrow(Ident("OpNat"), Cons(Arrow(Ident("OpNat"), Cons(Lift(Ident("OpNat")), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty))))), rule: Fn("opnat_max", Der { ctx: Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), dir: Check(Thk(Empty, Cons(Arrow(Ident("OpNat"), Cons(Arrow(Ident("OpNat"), Cons(Lift(Ident("OpNat")), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), term: ThunkAnon(Fix("opnat_max", Lam("xo", Lam("yo", Case(Var("xo"), "_u", Ret(Var("yo")), "x", Case(Var("yo"), "_u", Ret(Var("yo")), "y", Let("sugar_if_scrutinee", PrimApp(NatLt(Var("x"), Var("y"))), IfThenElse(Var("sugar_if_scrutinee"), Ret(Var("yo")), Ret(Var("xo")))))))))), clas: Ok(Thk(Empty, Cons(Arrow(Ident("OpNat"), Cons(Arrow(Ident("OpNat"), Cons(Lift(Ident("OpNat")), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), rule: ThunkAnon(Der { ctx: Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), dir: Check(Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty))), term: Fix("opnat_max", Lam("xo", Lam("yo", Case(Var("xo"), "_u", Ret(Var("yo")), "x", Case(Var("yo"), "_u", Ret(Var("yo")), "y", Let("sugar_if_scrutinee", PrimApp(NatLt(Var("x"), Var("y"))), IfThenElse(Var("sugar_if_scrutinee"), Ret(Var("yo")), Ret(Var("xo"))))))))), clas: Ok(Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty))), rule: Fix("opnat_max", Der { ctx: Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), dir: Check(Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty))), term: Lam("xo", Lam("yo", Case(Var("xo"), "_u", Ret(Var("yo")), "x", Case(Var("yo"), "_u", Ret(Var("yo")), "y", Let("sugar_if_scrutinee", PrimApp(NatLt(Var("x"), Var("y"))), IfThenElse(Var("sugar_if_scrutinee"), Ret(Var("yo")), Ret(Var("xo")))))))), clas: Ok(Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty))), rule: Lam("xo", Der { ctx: Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Check(Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), term: Lam("yo", Case(Var("xo"), "_u", Ret(Var("yo")), "x", Case(Var("yo"), "_u", Ret(Var("yo")), "y", Let("sugar_if_scrutinee", PrimApp(NatLt(Var("x"), Var("y"))), IfThenElse(Var("sugar_if_scrutinee"), Ret(Var("yo")), Ret(Var("xo"))))))), clas: Ok(Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), rule: Lam("yo", Der { ctx: Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), term: Case(Var("xo"), "_u", Ret(Var("yo")), "x", Case(Var("yo"), "_u", Ret(Var("yo")), "y", Let("sugar_if_scrutinee", PrimApp(NatLt(Var("x"), Var("y"))), IfThenElse(Var("sugar_if_scrutinee"), Ret(Var("yo")), Ret(Var("xo")))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), rule: Case(Der { ctx: Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Synth, term: Var("xo"), clas: Ok(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), rule: Var("xo"), vis: DerVis { tmfam: "Val", local_err: false } }, "_u", Der { ctx: Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "_u", Unit), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), term: Ret(Var("yo")), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), rule: Ret(Der { ctx: Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "_u", Unit), dir: Check(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), term: Var("yo"), clas: Ok(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), rule: Var("yo"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, "x", Der { ctx: Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), term: Case(Var("yo"), "_u", Ret(Var("yo")), "y", Let("sugar_if_scrutinee", PrimApp(NatLt(Var("x"), Var("y"))), IfThenElse(Var("sugar_if_scrutinee"), Ret(Var("yo")), Ret(Var("xo"))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), rule: Case(Der { ctx: Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), dir: Synth, term: Var("yo"), clas: Ok(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), rule: Var("yo"), vis: DerVis { tmfam: "Val", local_err: false } }, "_u", Der { ctx: Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "_u", Unit), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), term: Ret(Var("yo")), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), rule: Ret(Der { ctx: Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "_u", Unit), dir: Check(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), term: Var("yo"), clas: Ok(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), rule: Var("yo"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, "y", Der { ctx: Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), term: Let("sugar_if_scrutinee", PrimApp(NatLt(Var("x"), Var("y"))), IfThenElse(Var("sugar_if_scrutinee"), Ret(Var("yo")), Ret(Var("xo")))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), rule: Let("sugar_if_scrutinee", Der { ctx: Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), dir: Synth, term: PrimApp(NatLt(Var("x"), Var("y"))), clas: Ok(Cons(Lift(Prim(Bool)), WR(Empty, Empty))), rule: PrimApp(NatLt(Der { ctx: Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), dir: Synth, term: Var("x"), clas: Ok(Prim(Nat)), rule: Var("x"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), dir: Synth, term: Var("y"), clas: Ok(Prim(Nat)), rule: Var("y"), vis: DerVis { tmfam: "Val", local_err: false } })), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), "sugar_if_scrutinee", Prim(Bool)), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), term: IfThenElse(Var("sugar_if_scrutinee"), Ret(Var("yo")), Ret(Var("xo"))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), rule: IfThenElse(Der { ctx: Var(Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), "sugar_if_scrutinee", Prim(Bool)), dir: Synth, term: Var("sugar_if_scrutinee"), clas: Ok(Prim(Bool)), rule: Var("sugar_if_scrutinee"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), "sugar_if_scrutinee", Prim(Bool)), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), term: Ret(Var("yo")), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), rule: Ret(Der { ctx: Var(Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), "sugar_if_scrutinee", Prim(Bool)), dir: Check(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), term: Var("yo"), clas: Ok(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), rule: Var("yo"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), "sugar_if_scrutinee", Prim(Bool)), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), term: Ret(Var("xo")), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), rule: Ret(Der { ctx: Var(Var(Var(Var(Var(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "xo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "yo", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "x", Prim(Nat)), "y", Prim(Nat)), "sugar_if_scrutinee", Prim(Bool)), dir: Check(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), term: Var("xo"), clas: Ok(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), rule: Var("xo"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Module", local_err: false } } }), Bind(ItemDer { doc: Some("r\" Levels (as numbers), for level trees.\""), qual: Type, var: "Lev", der: Der { ctx: Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), dir: Synth, term: (), clas: Ok(Kind(NoParse("TODO-XXX-bitype.rs"))), rule: Type("Lev", Prim(Nat)), vis: DerVis { tmfam: "Module", local_err: false } } }), Bind(ItemDer { doc: Some("r\" are optional natural numbers:\""), qual: Type, var: "Seq", der: Der { ctx: Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), dir: Synth, term: (), clas: Ok(Kind(NoParse("TODO-XXX-bitype.rs"))), rule: Type("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), vis: DerVis { tmfam: "Module", local_err: false } } }), Bind(ItemDer { doc: Some("r\" (-`_SR`) over a sequence:\""), qual: IdxTm, var: "Seq_SR", der: Der { ctx: Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), dir: Synth, term: (), clas: Ok(Sort(IdxArrow(Nm, NmSet))), rule: IdxTm("Seq_SR", Der { ctx: Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), dir: Synth, term: Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), clas: Ok(IdxArrow(Nm, NmSet)), rule: Lam("x", Nm, Der { ctx: IVar(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "x", Nm), dir: Synth, term: Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2))))), clas: Ok(NmSet), rule: Apart(Der { ctx: IVar(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "x", Nm), dir: Synth, term: Sing(Bin(Var("x"), Name(Num(1)))), clas: Ok(NmSet), rule: Sing(Der { ctx: IVar(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "x", Nm), dir: Synth, term: Bin(Var("x"), Name(Num(1))), clas: Ok(Nm), rule: Bin(Der { ctx: IVar(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "x", Nm), dir: Synth, term: Var("x"), clas: Ok(Nm), rule: Var("x"), vis: DerVis { tmfam: "NmTm", local_err: false } }, Der { ctx: IVar(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "x", Nm), dir: Synth, term: Name(Num(1)), clas: Ok(Nm), rule: Name(Num(1)), vis: DerVis { tmfam: "NmTm", local_err: false } }), vis: DerVis { tmfam: "NmTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }, Der { ctx: IVar(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "x", Nm), dir: Synth, term: Sing(Bin(Var("x"), Name(Num(2)))), clas: Ok(NmSet), rule: Sing(Der { ctx: IVar(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "x", Nm), dir: Synth, term: Bin(Var("x"), Name(Num(2))), clas: Ok(Nm), rule: Bin(Der { ctx: IVar(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "x", Nm), dir: Synth, term: Var("x"), clas: Ok(Nm), rule: Var("x"), vis: DerVis { tmfam: "NmTm", local_err: false } }, Der { ctx: IVar(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "x", Nm), dir: Synth, term: Name(Num(2)), clas: Ok(Nm), rule: Name(Num(2)), vis: DerVis { tmfam: "NmTm", local_err: false } }), vis: DerVis { tmfam: "NmTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "Module", local_err: false } } }), Bind(ItemDer { doc: Some("r\" `@!` below, as a nameset-level function\""), qual: IdxTm, var: "WS_Seq_SR", der: Der { ctx: Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), dir: Synth, term: (), clas: Ok(Sort(IdxArrow(NmSet, NmSet))), rule: IdxTm("WS_Seq_SR", Der { ctx: Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), dir: Synth, term: Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))), clas: Ok(IdxArrow(NmSet, NmSet)), rule: Lam("x", NmSet, Der { ctx: IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), dir: Synth, term: App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x"))), clas: Ok(NmSet), rule: App(Der { ctx: IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), dir: Synth, term: WriteScope, clas: Ok(IdxArrow(NmSet, NmSet)), rule: WriteScope, vis: DerVis { tmfam: "IdxTm", local_err: false } }, Der { ctx: IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), dir: Synth, term: FlatMap(Ident("Seq_SR"), Var("x")), clas: Ok(NmSet), rule: FlatMap(Der { ctx: IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), dir: Synth, term: Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), clas: Ok(IdxArrow(Nm, NmSet)), rule: Lam("x", Nm, Der { ctx: IVar(IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), "x", Nm), dir: Synth, term: Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2))))), clas: Ok(NmSet), rule: Apart(Der { ctx: IVar(IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), "x", Nm), dir: Synth, term: Sing(Bin(Var("x"), Name(Num(1)))), clas: Ok(NmSet), rule: Sing(Der { ctx: IVar(IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), "x", Nm), dir: Synth, term: Bin(Var("x"), Name(Num(1))), clas: Ok(Nm), rule: Bin(Der { ctx: IVar(IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), "x", Nm), dir: Synth, term: Var("x"), clas: Ok(Nm), rule: Var("x"), vis: DerVis { tmfam: "NmTm", local_err: false } }, Der { ctx: IVar(IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), "x", Nm), dir: Synth, term: Name(Num(1)), clas: Ok(Nm), rule: Name(Num(1)), vis: DerVis { tmfam: "NmTm", local_err: false } }), vis: DerVis { tmfam: "NmTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }, Der { ctx: IVar(IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), "x", Nm), dir: Synth, term: Sing(Bin(Var("x"), Name(Num(2)))), clas: Ok(NmSet), rule: Sing(Der { ctx: IVar(IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), "x", Nm), dir: Synth, term: Bin(Var("x"), Name(Num(2))), clas: Ok(Nm), rule: Bin(Der { ctx: IVar(IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), "x", Nm), dir: Synth, term: Var("x"), clas: Ok(Nm), rule: Var("x"), vis: DerVis { tmfam: "NmTm", local_err: false } }, Der { ctx: IVar(IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), "x", Nm), dir: Synth, term: Name(Num(2)), clas: Ok(Nm), rule: Name(Num(2)), vis: DerVis { tmfam: "NmTm", local_err: false } }), vis: DerVis { tmfam: "NmTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }, Der { ctx: IVar(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "x", NmSet), dir: Synth, term: Var("x"), clas: Ok(NmSet), rule: Var("x"), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "Module", local_err: false } } })], Der { ctx: Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), dir: Synth, term: Let("max", AnnoC(Ret(ThunkAnon(Fix("max", Lam("seq", Unroll(Var("seq"), "sugar_match_unroll", Case(Var("sugar_match_unroll"), "on", Ret(Var("on")), "bin", Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))))))))))))))), Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(Ident("Seq"), Var("X")), Var("Y")), Cons(Lift(Ident("OpNat")), WR(App(Ident("WS_Seq_SR"), Var("X")), Apart(Var("Y"), App(Ident("WS_Seq_SR"), Var("X")))))), WR(Empty, Empty))))))), Ret(Nat(0))), clas: Ok(Cons(Lift(Prim(Nat)), WR(Empty, Empty))), rule: Let("max", Der { ctx: Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), dir: Synth, term: AnnoC(Ret(ThunkAnon(Fix("max", Lam("seq", Unroll(Var("seq"), "sugar_match_unroll", Case(Var("sugar_match_unroll"), "on", Ret(Var("on")), "bin", Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))))))))))))))), Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(Ident("Seq"), Var("X")), Var("Y")), Cons(Lift(Ident("OpNat")), WR(App(Ident("WS_Seq_SR"), Var("X")), Apart(Var("Y"), App(Ident("WS_Seq_SR"), Var("X")))))), WR(Empty, Empty))))))), clas: Ok(Cons(Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), WR(Empty, Empty))), rule: AnnoC(Der { ctx: Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), dir: Check(Cons(Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), WR(Empty, Empty))), term: Ret(ThunkAnon(Fix("max", Lam("seq", Unroll(Var("seq"), "sugar_match_unroll", Case(Var("sugar_match_unroll"), "on", Ret(Var("on")), "bin", Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))))))))))))))), clas: Ok(Cons(Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), WR(Empty, Empty))), rule: Ret(Der { ctx: Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), dir: Check(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), term: ThunkAnon(Fix("max", Lam("seq", Unroll(Var("seq"), "sugar_match_unroll", Case(Var("sugar_match_unroll"), "on", Ret(Var("on")), "bin", Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))))))))))))))))))))), clas: Ok(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), rule: ThunkAnon(Der { ctx: Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), dir: Check(ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty))))), term: Fix("max", Lam("seq", Unroll(Var("seq"), "sugar_match_unroll", Case(Var("sugar_match_unroll"), "on", Ret(Var("on")), "bin", Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))))))))))))), clas: Ok(ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty))))), rule: Fix("max", Der { ctx: Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), dir: Check(ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty))))), term: Lam("seq", Unroll(Var("seq"), "sugar_match_unroll", Case(Var("sugar_match_unroll"), "on", Ret(Var("on")), "bin", Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))))))))))))))))))), clas: Ok(Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty))), rule: Lam("seq", Der { ctx: Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Unroll(Var("seq"), "sugar_match_unroll", Case(Var("sugar_match_unroll"), "on", Ret(Var("on")), "bin", Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Unroll(Der { ctx: Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), dir: Synth, term: Var("seq"), clas: Ok(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), rule: Var("seq"), vis: DerVis { tmfam: "Val", local_err: false } }, "sugar_match_unroll", Der { ctx: Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Case(Var("sugar_match_unroll"), "on", Ret(Var("on")), "bin", Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))))))))))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Case(Der { ctx: Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), dir: Synth, term: Var("sugar_match_unroll"), clas: Ok(IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), rule: Var("sugar_match_unroll"), vis: DerVis { tmfam: "Val", local_err: false } }, "on", Der { ctx: Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "on", Sum(Unit, Prim(Nat))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Ret(Var("on")), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Ret(Der { ctx: Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "on", Sum(Unit, Prim(Nat))), dir: Check(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), term: Var("on"), clas: Ok(Sum(Unit, Prim(Nat))), rule: Var("on"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, "bin", Der { ctx: Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Unpack("X1", "sugar_unpack_multi", Var("bin"), Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Unpack("X1", "sugar_unpack_multi", Der { ctx: Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), dir: Synth, term: Var("bin"), clas: Ok(Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), rule: Var("bin"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Unpack("X2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))))))))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Unpack("X2", "sugar_unpack_multi", Der { ctx: Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), dir: Synth, term: Var("sugar_unpack_multi"), clas: Ok(Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), rule: Var("sugar_unpack_multi"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Unpack("X3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Unpack("X3", "sugar_unpack_multi", Der { ctx: Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), dir: Synth, term: Var("sugar_unpack_multi"), clas: Ok(Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), rule: Var("sugar_unpack_multi"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Unpack("Y1", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))))))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Unpack("Y1", "sugar_unpack_multi", Der { ctx: Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), dir: Synth, term: Var("sugar_unpack_multi"), clas: Ok(Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), rule: Var("sugar_unpack_multi"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Unpack("Y2", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Unpack("Y2", "sugar_unpack_multi", Der { ctx: Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), dir: Synth, term: Var("sugar_unpack_multi"), clas: Ok(Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), rule: Var("sugar_unpack_multi"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Unpack("Y3", "sugar_unpack_multi", Var("sugar_unpack_multi"), Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Unpack("Y3", "sugar_unpack_multi", Der { ctx: Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), dir: Synth, term: Var("sugar_unpack_multi"), clas: Ok(Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), rule: Var("sugar_unpack_multi"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Unpack("Y4", "bin", Var("sugar_unpack_multi"), Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Unpack("Y4", "bin", Der { ctx: Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), dir: Synth, term: Var("sugar_unpack_multi"), clas: Ok(Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), rule: Var("sugar_unpack_multi"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Let("let_split_sugar", Ret(Var("bin")), Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Let("let_split_sugar", Der { ctx: Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), dir: Synth, term: Ret(Var("bin")), clas: Ok(Cons(Lift(Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), WR(Empty, Empty))), rule: Ret(Der { ctx: Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), dir: Synth, term: Var("bin"), clas: Ok(Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), rule: Var("bin"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Split(Var("let_split_sugar"), "n", "sugar_split_snd", Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Split(Der { ctx: Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), dir: Synth, term: Var("let_split_sugar"), clas: Ok(Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), rule: Var("let_split_sugar"), vis: DerVis { tmfam: "Val", local_err: false } }, "n", "sugar_split_snd", Der { ctx: Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Split(Var("sugar_split_snd"), "lev", "sugar_split_snd", Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Split(Der { ctx: Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), dir: Synth, term: Var("sugar_split_snd"), clas: Ok(Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), rule: Var("sugar_split_snd"), vis: DerVis { tmfam: "Val", local_err: false } }, "lev", "sugar_split_snd", Der { ctx: Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Split(Var("sugar_split_snd"), "l", "r", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Split(Der { ctx: Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), dir: Synth, term: Var("sugar_split_snd"), clas: Ok(Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), rule: Var("sugar_split_snd"), vis: DerVis { tmfam: "Val", local_err: false } }, "l", "r", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Let("let_split_sugar", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), dir: Synth, term: Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(1)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), clas: Ok(Cons(Lift(Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), WR(Apart(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2"))), Union(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), Union(Var("Y1"), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))))), rule: Let("memo_name_sugar", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), dir: Synth, term: PrimApp(NameBin(Var("n"), Name(Num(1)))), clas: Ok(Cons(Lift(Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), WR(Empty, Empty))), rule: PrimApp(NameBin(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), dir: Synth, term: Var("n"), clas: Ok(Nm(Var("X1"))), rule: Var("n"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), dir: Synth, term: Name(Num(1)), clas: Ok(Nm(Sing(Name(Num(1))))), rule: Name(Num(1)), vis: DerVis { tmfam: "Val", local_err: false } })), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), dir: Synth, term: Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), PrimApp(RefThunk(Var("memo_keyword_sugar")))), clas: Ok(Cons(Lift(Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), WR(Apart(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2"))), Union(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), Union(Var("Y1"), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))))), rule: Let("memo_keyword_sugar", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), dir: Synth, term: Thunk(Var("memo_name_sugar"), Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")))), clas: Ok(Cons(Lift(Thk(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")), Union(Var("Y1"), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))))), WR(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), Empty))), rule: Thunk(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), dir: Synth, term: Var("memo_name_sugar"), clas: Ok(Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), rule: Var("memo_name_sugar"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), dir: Synth, term: Let("app_get_sugar_l", Get(Var("l")), App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l"))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")), Union(Var("Y1"), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2"))))))), rule: Let("app_get_sugar_l", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), dir: Synth, term: Get(Var("l")), clas: Ok(Cons(Lift(IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), WR(Empty, Var("Y1")))), rule: Get(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), dir: Synth, term: Var("l"), clas: Ok(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), rule: Var("l"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "app_get_sugar_l", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), dir: Synth, term: App(IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), Var("app_get_sugar_l")), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))), rule: App(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "app_get_sugar_l", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), dir: Synth, term: IdxApp(IdxApp(Force(Var("max")), Var("X2")), Var("Y2")), clas: Ok(Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X2")), Var("Y2")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))), WR(Empty, Empty))), rule: IdxApp(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "app_get_sugar_l", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), dir: Synth, term: IdxApp(Force(Var("max")), Var("X2")), clas: Ok(ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X2")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")), Apart(Var("Y"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))), WR(Empty, Empty)))), rule: IdxApp(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "app_get_sugar_l", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), dir: Synth, term: Force(Var("max")), clas: Ok(ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty))))), rule: Force(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "app_get_sugar_l", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), dir: Synth, term: Var("max"), clas: Ok(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), rule: Var("max"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "app_get_sugar_l", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), dir: Synth, term: Var("X2"), clas: Ok(NmSet), rule: Var("X2"), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "app_get_sugar_l", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), dir: Synth, term: Var("Y2"), clas: Ok(NmSet), rule: Var("Y2"), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "app_get_sugar_l", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), dir: Check(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X2")), Var("Y2"))), term: Var("app_get_sugar_l"), clas: Ok(IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), rule: Var("app_get_sugar_l"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "memo_keyword_sugar", Thk(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")), Union(Var("Y1"), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))))), dir: Synth, term: PrimApp(RefThunk(Var("memo_keyword_sugar"))), clas: Ok(Cons(Lift(Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")), Union(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), Union(Var("Y1"), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))))), rule: PrimApp(RefThunk(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(1)))))), "memo_keyword_sugar", Thk(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")), Union(Var("Y1"), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))))), dir: Synth, term: Var("memo_keyword_sugar"), clas: Ok(Thk(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")), Union(Var("Y1"), Apart(Var("Y2"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X2")))))))), rule: Var("memo_keyword_sugar"), vis: DerVis { tmfam: "Val", local_err: false } })), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(NmSet(NmSet { cons: Some(Apart), terms: [Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(2)))), Var("X1")))), Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(1)))), Var("X3")))), Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(2)))), Var("X3"))))] }), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Split(Var("let_split_sugar"), "_rsl", "ml", Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(NmSet(NmSet { cons: Some(Apart), terms: [Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(2)))), Var("X1")))), Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(1)))), Var("X3")))), Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(2)))), Var("X3"))))] }), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Split(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), dir: Synth, term: Var("let_split_sugar"), clas: Ok(Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), rule: Var("let_split_sugar"), vis: DerVis { tmfam: "Val", local_err: false } }, "_rsl", "ml", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(NmSet(NmSet { cons: Some(Apart), terms: [Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(2)))), Var("X1")))), Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(1)))), Var("X3")))), Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(2)))), Var("X3"))))] }), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Let("let_split_sugar", Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(NmSet(NmSet { cons: Some(Apart), terms: [Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(2)))), Var("X1")))), Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(1)))), Var("X3")))), Subset(Map(WriteScope, Map(Lam("x", Nm, Bin(Var("x"), Name(Num(2)))), Var("X3"))))] }), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Let("let_split_sugar", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Synth, term: Let("memo_name_sugar", PrimApp(NameBin(Var("n"), Name(Num(2)))), Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar"))))), clas: Ok(Cons(Lift(Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), WR(Apart(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3"))), Union(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), Union(Var("Y3"), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))))), rule: Let("memo_name_sugar", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Synth, term: PrimApp(NameBin(Var("n"), Name(Num(2)))), clas: Ok(Cons(Lift(Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), WR(Empty, Empty))), rule: PrimApp(NameBin(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Synth, term: Var("n"), clas: Ok(Nm(Var("X1"))), rule: Var("n"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Synth, term: Name(Num(2)), clas: Ok(Nm(Sing(Name(Num(2))))), rule: Name(Num(2)), vis: DerVis { tmfam: "Val", local_err: false } })), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), dir: Synth, term: Let("memo_keyword_sugar", Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), PrimApp(RefThunk(Var("memo_keyword_sugar")))), clas: Ok(Cons(Lift(Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), WR(Apart(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3"))), Union(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), Union(Var("Y3"), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))))), rule: Let("memo_keyword_sugar", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), dir: Synth, term: Thunk(Var("memo_name_sugar"), Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")))), clas: Ok(Cons(Lift(Thk(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")), Union(Var("Y3"), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))))), WR(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), Empty))), rule: Thunk(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), dir: Synth, term: Var("memo_name_sugar"), clas: Ok(Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), rule: Var("memo_name_sugar"), vis: DerVis { tmfam: "Val", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), dir: Synth, term: Let("app_get_sugar_r", Get(Var("r")), App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r"))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")), Union(Var("Y3"), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3"))))))), rule: Let("app_get_sugar_r", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), dir: Synth, term: Get(Var("r")), clas: Ok(Cons(Lift(IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), WR(Empty, Var("Y3")))), rule: Get(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), dir: Synth, term: Var("r"), clas: Ok(Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), rule: Var("r"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "app_get_sugar_r", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), dir: Synth, term: App(IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), Var("app_get_sugar_r")), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))), rule: App(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "app_get_sugar_r", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), dir: Synth, term: IdxApp(IdxApp(Force(Var("max")), Var("X3")), Var("Y4")), clas: Ok(Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X3")), Var("Y4")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))), WR(Empty, Empty))), rule: IdxApp(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "app_get_sugar_r", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), dir: Synth, term: IdxApp(Force(Var("max")), Var("X3")), clas: Ok(ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X3")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")), Apart(Var("Y"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))), WR(Empty, Empty)))), rule: IdxApp(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "app_get_sugar_r", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), dir: Synth, term: Force(Var("max")), clas: Ok(ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty))))), rule: Force(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "app_get_sugar_r", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), dir: Synth, term: Var("max"), clas: Ok(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), rule: Var("max"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "app_get_sugar_r", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), dir: Synth, term: Var("X3"), clas: Ok(NmSet), rule: Var("X3"), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "app_get_sugar_r", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), dir: Synth, term: Var("Y4"), clas: Ok(NmSet), rule: Var("Y4"), vis: DerVis { tmfam: "IdxTm", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "app_get_sugar_r", IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), dir: Check(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X3")), Var("Y4"))), term: Var("app_get_sugar_r"), clas: Ok(IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))), rule: Var("app_get_sugar_r"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "memo_keyword_sugar", Thk(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")), Union(Var("Y3"), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))))), dir: Synth, term: PrimApp(RefThunk(Var("memo_keyword_sugar"))), clas: Ok(Cons(Lift(Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")), Union(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), Union(Var("Y3"), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))))), rule: PrimApp(RefThunk(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "memo_name_sugar", Nm(Bin(Var("X1"), Sing(Name(Num(2)))))), "memo_keyword_sugar", Thk(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")), Union(Var("Y3"), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))))), dir: Synth, term: Var("memo_keyword_sugar"), clas: Ok(Thk(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")), Union(Var("Y3"), Apart(Var("Y4"), App(Lam("x", NmSet, App(Lam("x", NmSet, Map(WriteScope, Var("x"))), FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X3")))))))), rule: Var("memo_keyword_sugar"), vis: DerVis { tmfam: "Val", local_err: false } })), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), dir: Check(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), term: Split(Var("let_split_sugar"), "_rsr", "mr", App(App(Force(Var("opnat_max")), Var("ml")), Var("mr"))), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), rule: Split(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), dir: Synth, term: Var("let_split_sugar"), clas: Ok(Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), rule: Var("let_split_sugar"), vis: DerVis { tmfam: "Val", local_err: false } }, "_rsr", "mr", Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsr", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "mr", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Synth, term: App(App(Force(Var("opnat_max")), Var("ml")), Var("mr")), clas: Ok(Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), rule: App(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsr", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "mr", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Synth, term: App(Force(Var("opnat_max")), Var("ml")), clas: Ok(Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), rule: App(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsr", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "mr", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Synth, term: Force(Var("opnat_max")), clas: Ok(Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty))), rule: Force(Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsr", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "mr", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Synth, term: Var("opnat_max"), clas: Ok(Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), rule: Var("opnat_max"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsr", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "mr", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Check(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), term: Var("ml"), clas: Ok(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), rule: Var("ml"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(IVar(Var(PropTrue(IVar(Var(IVar(Var(IVar(Var(Var(Var(IVar(IVar(Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), "X", NmSet), "Y", NmSet), "seq", IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y"))), "sugar_match_unroll", IdxApp(IdxApp(IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))))), Var("X")), Var("Y"))), "bin", Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))))), "X1", NmSet), "sugar_unpack_multi", Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))))), "X2", NmSet), "sugar_unpack_multi", Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))))), "X3", NmSet), Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet)), "sugar_unpack_multi", Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))))), "Y1", NmSet), "sugar_unpack_multi", Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))))), "Y2", NmSet), "sugar_unpack_multi", Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))))), "Y3", NmSet), "sugar_unpack_multi", Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))))), "Y4", NmSet), Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet)), "bin", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "let_split_sugar", Prod(Nm(Var("X1")), Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))))), "n", Nm(Var("X1"))), "sugar_split_snd", Prod(Prim(Nat), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))))), "lev", Prim(Nat)), "sugar_split_snd", Prod(Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4"))))), "l", Ref(Var("Y1"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X2")), Var("Y2")))), "r", Ref(Var("Y3"), IdxApp(IdxApp(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))), Var("X3")), Var("Y4")))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsl", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(1))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "ml", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), "let_split_sugar", Prod(Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat)))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "_rsr", Ref(Map(WriteScope, Bin(Var("X1"), Sing(Name(Num(2))))), IdentDef("OpNat", Sum(Unit, Prim(Nat))))), "mr", IdentDef("OpNat", Sum(Unit, Prim(Nat)))), dir: Check(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), term: Var("mr"), clas: Ok(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), rule: Var("mr"), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, Lift(Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty))))))), vis: DerVis { tmfam: "Exp", local_err: false } }, Der { ctx: Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), dir: Synth, term: Ret(Nat(0)), clas: Ok(Cons(Lift(Prim(Nat)), WR(Empty, Empty))), rule: Ret(Der { ctx: Var(Def(Def(Def(Def(Var(Def(Empty, "OpNat", Type(Sum(Unit, Prim(Nat)))), "opnat_max", Thk(Empty, Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Arrow(IdentDef("OpNat", Sum(Unit, Prim(Nat))), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(Empty, Empty))), WR(Empty, Empty))), WR(Empty, Empty)))), "Lev", Type(Prim(Nat))), "Seq", Type(Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4"))))))))))))))))))), "Seq_SR", IdxTm(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))))), "WS_Seq_SR", IdxTm(Lam("x", NmSet, App(WriteScope, FlatMap(Ident("Seq_SR"), Var("x")))))), "max", Thk(Empty, ForallIdx("X", NmSet, Tt, ForallIdx("Y", NmSet, Tt, Cons(Arrow(IdxApp(IdxApp(IdentDef("Seq", Rec("seq", IdxFn("X", NmSet, IdxFn("Y", NmSet, Sum(Sum(Unit, Prim(Nat)), Exists("X1", NmSet, Tt, Exists("X2", NmSet, Tt, Exists("X3", NmSet, Equiv(Apart(Apart(Var("X1"), Var("X2")), Var("X3")), Var("X"), NmSet), Exists("Y1", NmSet, Tt, Exists("Y2", NmSet, Tt, Exists("Y3", NmSet, Tt, Exists("Y4", NmSet, Equiv(Apart(Apart(Apart(Var("Y1"), Var("Y2")), Var("Y3")), Var("Y4")), Var("Y"), NmSet), Prod(Nm(Var("X1")), Prod(IdentDef("Lev", Prim(Nat)), Prod(Ref(Var("Y1"), IdxApp(IdxApp(Var("seq"), Var("X2")), Var("Y2"))), Ref(Var("Y3"), IdxApp(IdxApp(Var("seq"), Var("X3")), Var("Y4")))))))))))))))))), Var("X")), Var("Y")), Cons(Lift(IdentDef("OpNat", Sum(Unit, Prim(Nat)))), WR(App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")), Apart(Var("Y"), App(Lam("x", NmSet, App(WriteScope, FlatMap(Lam("x", Nm, Apart(Sing(Bin(Var("x"), Name(Num(1)))), Sing(Bin(Var("x"), Name(Num(2)))))), Var("x")))), Var("X")))))), WR(Empty, Empty)))))), dir: Synth, term: Nat(0), clas: Ok(Prim(Nat)), rule: Nat(0), vis: DerVis { tmfam: "Val", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }), vis: DerVis { tmfam: "Exp", local_err: false } }, traces: [] }